{
    "address": "SGn4NkCwTLFZ46HsKzNaPxobdzXFJ7LHNCea68kiL2u",
    "metadata": {
        "name": "bulwark_storage",
        "version": "0.1.0",
        "spec": "0.1.0",
        "description": "Created with Arcium & Anchor"
    },
    "instructions": [
        {
            "name": "get_audit_by_id",
            "docs": [
                "Retrieves audit results by report ID.",
                "Data can be read directly from the PDA account."
            ],
            "discriminator": [
                61,
                142,
                207,
                100,
                123,
                72,
                81,
                167
            ],
            "accounts": [
                {
                    "name": "audit_record",
                    "pda": {
                        "seeds": [
                            {
                                "kind": "const",
                                "value": [
                                    97,
                                    117,
                                    100,
                                    105,
                                    116,
                                    95,
                                    114,
                                    101,
                                    99,
                                    111,
                                    114,
                                    100
                                ]
                            },
                            {
                                "kind": "arg",
                                "path": "report_id"
                            }
                        ]
                    }
                }
            ],
            "args": []
        },
        {
            "name": "init_share_commit_hash_comp_def",
            "docs": [
                "Initializes the computation definition for the `share_commit_hash` circuit."
            ],
            "discriminator": [
                190,
                253,
                57,
                54,
                63,
                243,
                215,
                192
            ],
            "accounts": [
                {
                    "name": "payer",
                    "writable": true,
                    "signer": true
                },
                {
                    "name": "mxe_account",
                    "writable": true
                },
                {
                    "name": "comp_def_account",
                    "docs": [
                        "Can't check it here as it's not initialized yet."
                    ],
                    "writable": true
                },
                {
                    "name": "arcium_program",
                    "address": "BKck65TgoKRokMjQM3datB9oRwJ8rAj2jxPXvHXUvcL6"
                },
                {
                    "name": "system_program",
                    "address": "11111111111111111111111111111111"
                }
            ],
            "args": []
        },
        {
            "name": "share_commit_hash_callback",
            "discriminator": [
                77,
                82,
                203,
                15,
                155,
                230,
                69,
                196
            ],
            "accounts": [
                {
                    "name": "arcium_program",
                    "address": "BKck65TgoKRokMjQM3datB9oRwJ8rAj2jxPXvHXUvcL6"
                },
                {
                    "name": "comp_def_account"
                },
                {
                    "name": "instructions_sysvar",
                    "address": "Sysvar1nstructions1111111111111111111111111"
                }
            ],
            "args": [
                {
                    "name": "output",
                    "type": {
                        "defined": {
                            "name": "ComputationOutputs",
                            "generics": [
                                {
                                    "kind": "type",
                                    "type": {
                                        "defined": {
                                            "name": "ShareCommitHashOutput"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                }
            ]
        },
        {
            "name": "share_commit_hash_chunk",
            "docs": [
                "Shares two encrypted commit-hash bytes with a receiver by invoking",
                "the `share_commit_hash` circuit. This demonstrates how Arcium MPC can",
                "be used to collaborate on encrypted commit hash data."
            ],
            "discriminator": [
                11,
                117,
                250,
                217,
                52,
                252,
                97,
                0
            ],
            "accounts": [
                {
                    "name": "payer",
                    "writable": true,
                    "signer": true
                },
                {
                    "name": "sign_pda_account",
                    "writable": true,
                    "pda": {
                        "seeds": [
                            {
                                "kind": "const",
                                "value": [
                                    83,
                                    105,
                                    103,
                                    110,
                                    101,
                                    114,
                                    65,
                                    99,
                                    99,
                                    111,
                                    117,
                                    110,
                                    116
                                ]
                            }
                        ]
                    }
                },
                {
                    "name": "mxe_account"
                },
                {
                    "name": "mempool_account",
                    "writable": true
                },
                {
                    "name": "executing_pool",
                    "writable": true
                },
                {
                    "name": "computation_account",
                    "writable": true
                },
                {
                    "name": "comp_def_account"
                },
                {
                    "name": "cluster_account",
                    "writable": true
                },
                {
                    "name": "pool_account",
                    "writable": true,
                    "address": "7MGSS4iKNM4sVib7bDZDJhVqB6EcchPwVnTKenCY1jt3"
                },
                {
                    "name": "clock_account",
                    "address": "FHriyvoZotYiFnbUzKFjzRSb2NiaC8RPWY7jtKuKhg65"
                },
                {
                    "name": "system_program",
                    "address": "11111111111111111111111111111111"
                },
                {
                    "name": "arcium_program",
                    "address": "BKck65TgoKRokMjQM3datB9oRwJ8rAj2jxPXvHXUvcL6"
                }
            ],
            "args": [
                {
                    "name": "computation_offset",
                    "type": "u64"
                },
                {
                    "name": "encrypted_upper_byte",
                    "type": {
                        "array": [
                            "u8",
                            32
                        ]
                    }
                },
                {
                    "name": "encrypted_lower_byte",
                    "type": {
                        "array": [
                            "u8",
                            32
                        ]
                    }
                },
                {
                    "name": "receiver_pub_key",
                    "type": {
                        "array": [
                            "u8",
                            32
                        ]
                    }
                },
                {
                    "name": "receiver_nonce",
                    "type": "u128"
                }
            ]
        },
        {
            "name": "store_audit_results",
            "docs": [
                "Stores audit results with transparent pricing and encrypted commit hash.",
                "",
                "This function demonstrates Arcium's encryption capabilities by storing:",
                "- PLAINTEXT: report_id, effort estimates, resources, cost range (USD), score",
                "- ENCRYPTED: commit_hash (encrypted client-side using Arcium's RescueCipher)",
                "",
                "The encrypted commit hash is provided as a 32-byte array that was encrypted",
                "by the client using Arcium's x25519 key exchange and RescueCipher.",
                "",
                "# Arguments",
                "* `report_id` - Unique identifier for this audit report",
                "* `min_days` - Minimum days estimate",
                "* `max_days` - Maximum days estimate",
                "* `min_resources` - Minimum auditors needed",
                "* `max_resources` - Maximum auditors needed",
                "* `min_cost_usd` - Minimum cost estimate in USD",
                "* `max_cost_usd` - Maximum cost estimate in USD",
                "* `score` - Audit score (0-100)",
                "* `encrypted_commit_hash` - Commit hash encrypted using Arcium RescueCipher"
            ],
            "discriminator": [
                232,
                57,
                220,
                42,
                42,
                218,
                92,
                194
            ],
            "accounts": [
                {
                    "name": "payer",
                    "writable": true,
                    "signer": true
                },
                {
                    "name": "audit_record",
                    "writable": true,
                    "pda": {
                        "seeds": [
                            {
                                "kind": "const",
                                "value": [
                                    97,
                                    117,
                                    100,
                                    105,
                                    116,
                                    95,
                                    114,
                                    101,
                                    99,
                                    111,
                                    114,
                                    100
                                ]
                            },
                            {
                                "kind": "arg",
                                "path": "report_id"
                            }
                        ]
                    }
                },
                {
                    "name": "system_program",
                    "address": "11111111111111111111111111111111"
                }
            ],
            "args": [
                {
                    "name": "report_id",
                    "type": "u64"
                },
                {
                    "name": "min_days",
                    "type": "u16"
                },
                {
                    "name": "max_days",
                    "type": "u16"
                },
                {
                    "name": "min_resources",
                    "type": "u8"
                },
                {
                    "name": "max_resources",
                    "type": "u8"
                },
                {
                    "name": "min_cost_usd",
                    "type": "u64"
                },
                {
                    "name": "max_cost_usd",
                    "type": "u64"
                },
                {
                    "name": "score",
                    "type": "u8"
                },
                {
                    "name": "encrypted_commit_hash",
                    "type": {
                        "array": [
                            "u8",
                            32
                        ]
                    }
                }
            ]
        }
    ],
    "accounts": [
        {
            "name": "AuditRecord",
            "discriminator": [
                23,
                133,
                250,
                12,
                85,
                60,
                64,
                139
            ]
        },
        {
            "name": "ClockAccount",
            "discriminator": [
                152,
                171,
                158,
                195,
                75,
                61,
                51,
                8
            ]
        },
        {
            "name": "Cluster",
            "discriminator": [
                236,
                225,
                118,
                228,
                173,
                106,
                18,
                60
            ]
        },
        {
            "name": "ComputationDefinitionAccount",
            "discriminator": [
                245,
                176,
                217,
                221,
                253,
                104,
                172,
                200
            ]
        },
        {
            "name": "FeePool",
            "discriminator": [
                172,
                38,
                77,
                146,
                148,
                5,
                51,
                242
            ]
        },
        {
            "name": "MXEAccount",
            "discriminator": [
                103,
                26,
                85,
                250,
                179,
                159,
                17,
                117
            ]
        },
        {
            "name": "SignerAccount",
            "discriminator": [
                127,
                212,
                7,
                180,
                17,
                50,
                249,
                193
            ]
        }
    ],
    "events": [
        {
            "name": "AuditStoredEvent",
            "discriminator": [
                174,
                148,
                121,
                54,
                138,
                237,
                10,
                104
            ]
        },
        {
            "name": "CommitHashSharedEvent",
            "discriminator": [
                156,
                167,
                190,
                16,
                207,
                74,
                84,
                227
            ]
        }
    ],
    "errors": [
        {
            "code": 6000,
            "name": "InvalidReportId",
            "msg": "Invalid report ID"
        },
        {
            "code": 6001,
            "name": "InvalidScore",
            "msg": "Invalid score (must be 0-100)"
        },
        {
            "code": 6002,
            "name": "AbortedComputation",
            "msg": "The computation was aborted"
        },
        {
            "code": 6003,
            "name": "ClusterNotSet",
            "msg": "Cluster not set"
        }
    ],
    "types": [
        {
            "name": "Activation",
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "activation_epoch",
                        "type": {
                            "defined": {
                                "name": "Epoch"
                            }
                        }
                    },
                    {
                        "name": "deactivation_epoch",
                        "type": {
                            "defined": {
                                "name": "Epoch"
                            }
                        }
                    }
                ]
            }
        },
        {
            "name": "AuditRecord",
            "docs": [
                "Audit record storage account.",
                "",
                "This account stores both plaintext and encrypted data:",
                "- Plaintext fields are visible to anyone on Solscan",
                "- Encrypted commit hash can only be decrypted with the private key"
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "report_id",
                        "type": "u64"
                    },
                    {
                        "name": "min_days",
                        "type": "u16"
                    },
                    {
                        "name": "max_days",
                        "type": "u16"
                    },
                    {
                        "name": "min_resources",
                        "type": "u8"
                    },
                    {
                        "name": "max_resources",
                        "type": "u8"
                    },
                    {
                        "name": "min_cost_usd",
                        "type": "u64"
                    },
                    {
                        "name": "max_cost_usd",
                        "type": "u64"
                    },
                    {
                        "name": "score",
                        "type": "u8"
                    },
                    {
                        "name": "encrypted_commit_hash",
                        "type": {
                            "array": [
                                "u8",
                                32
                            ]
                        }
                    }
                ]
            }
        },
        {
            "name": "AuditStoredEvent",
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "report_id",
                        "type": "u64"
                    },
                    {
                        "name": "min_cost_usd",
                        "type": "u64"
                    },
                    {
                        "name": "max_cost_usd",
                        "type": "u64"
                    },
                    {
                        "name": "score",
                        "type": "u8"
                    }
                ]
            }
        },
        {
            "name": "CircuitSource",
            "type": {
                "kind": "enum",
                "variants": [
                    {
                        "name": "Local",
                        "fields": [
                            {
                                "defined": {
                                    "name": "LocalCircuitSource"
                                }
                            }
                        ]
                    },
                    {
                        "name": "OnChain",
                        "fields": [
                            {
                                "defined": {
                                    "name": "OnChainCircuitSource"
                                }
                            }
                        ]
                    },
                    {
                        "name": "OffChain",
                        "fields": [
                            {
                                "defined": {
                                    "name": "OffChainCircuitSource"
                                }
                            }
                        ]
                    }
                ]
            }
        },
        {
            "name": "ClockAccount",
            "docs": [
                "An account storing the current network epoch"
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "start_epoch",
                        "type": {
                            "defined": {
                                "name": "Epoch"
                            }
                        }
                    },
                    {
                        "name": "current_epoch",
                        "type": {
                            "defined": {
                                "name": "Epoch"
                            }
                        }
                    },
                    {
                        "name": "start_epoch_timestamp",
                        "type": {
                            "defined": {
                                "name": "Timestamp"
                            }
                        }
                    },
                    {
                        "name": "bump",
                        "type": "u8"
                    }
                ]
            }
        },
        {
            "name": "Cluster",
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "authority",
                        "type": {
                            "option": "pubkey"
                        }
                    },
                    {
                        "name": "max_size",
                        "type": "u32"
                    },
                    {
                        "name": "activation",
                        "type": {
                            "defined": {
                                "name": "Activation"
                            }
                        }
                    },
                    {
                        "name": "max_capacity",
                        "type": "u64"
                    },
                    {
                        "name": "cu_price",
                        "type": "u64"
                    },
                    {
                        "name": "cu_price_proposals",
                        "type": {
                            "array": [
                                "u64",
                                32
                            ]
                        }
                    },
                    {
                        "name": "last_updated_epoch",
                        "type": {
                            "defined": {
                                "name": "Epoch"
                            }
                        }
                    },
                    {
                        "name": "mxes",
                        "type": {
                            "vec": "pubkey"
                        }
                    },
                    {
                        "name": "nodes",
                        "type": {
                            "vec": {
                                "defined": {
                                    "name": "NodeRef"
                                }
                            }
                        }
                    },
                    {
                        "name": "pending_nodes",
                        "type": {
                            "vec": {
                                "defined": {
                                    "name": "NodeRef"
                                }
                            }
                        }
                    },
                    {
                        "name": "bump",
                        "type": "u8"
                    }
                ]
            }
        },
        {
            "name": "CommitHashSharedEvent",
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "chunk_ciphertext",
                        "type": {
                            "array": [
                                "u8",
                                32
                            ]
                        }
                    },
                    {
                        "name": "nonce",
                        "type": {
                            "array": [
                                "u8",
                                16
                            ]
                        }
                    }
                ]
            }
        },
        {
            "name": "ComputationDefinitionAccount",
            "docs": [
                "An account representing a [ComputationDefinition] in a MXE."
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "finalization_authority",
                        "type": {
                            "option": "pubkey"
                        }
                    },
                    {
                        "name": "finalize_during_callback",
                        "type": "bool"
                    },
                    {
                        "name": "cu_amount",
                        "type": "u64"
                    },
                    {
                        "name": "definition",
                        "type": {
                            "defined": {
                                "name": "ComputationDefinitionMeta"
                            }
                        }
                    },
                    {
                        "name": "circuit_source",
                        "type": {
                            "defined": {
                                "name": "CircuitSource"
                            }
                        }
                    },
                    {
                        "name": "bump",
                        "type": "u8"
                    }
                ]
            }
        },
        {
            "name": "ComputationDefinitionMeta",
            "docs": [
                "A computation definition for execution in a MXE."
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "circuit_len",
                        "type": "u32"
                    },
                    {
                        "name": "signature",
                        "type": {
                            "defined": {
                                "name": "ComputationSignature"
                            }
                        }
                    }
                ]
            }
        },
        {
            "name": "ComputationOutputs",
            "generics": [
                {
                    "kind": "type",
                    "name": "O"
                }
            ],
            "type": {
                "kind": "enum",
                "variants": [
                    {
                        "name": "Success",
                        "fields": [
                            {
                                "generic": "O"
                            }
                        ]
                    },
                    {
                        "name": "Failure"
                    }
                ]
            }
        },
        {
            "name": "ComputationSignature",
            "docs": [
                "The signature of a computation defined in a [ComputationDefinition]."
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "parameters",
                        "type": {
                            "vec": {
                                "defined": {
                                    "name": "Parameter"
                                }
                            }
                        }
                    },
                    {
                        "name": "outputs",
                        "type": {
                            "vec": {
                                "defined": {
                                    "name": "Output"
                                }
                            }
                        }
                    }
                ]
            }
        },
        {
            "name": "Epoch",
            "docs": [
                "The network epoch"
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    "u64"
                ]
            }
        },
        {
            "name": "FeePool",
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "bump",
                        "type": "u8"
                    }
                ]
            }
        },
        {
            "name": "LocalCircuitSource",
            "type": {
                "kind": "enum",
                "variants": [
                    {
                        "name": "MxeKeygen"
                    }
                ]
            }
        },
        {
            "name": "MXEAccount",
            "docs": [
                "A MPC Execution Environment."
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "authority",
                        "type": {
                            "option": "pubkey"
                        }
                    },
                    {
                        "name": "cluster",
                        "type": {
                            "option": "u32"
                        }
                    },
                    {
                        "name": "x25519_pubkey",
                        "type": {
                            "defined": {
                                "name": "X25519Pubkey"
                            }
                        }
                    },
                    {
                        "name": "fallback_clusters",
                        "type": {
                            "vec": "u32"
                        }
                    },
                    {
                        "name": "rejected_clusters",
                        "type": {
                            "vec": "u32"
                        }
                    },
                    {
                        "name": "computation_definitions",
                        "type": {
                            "vec": "u32"
                        }
                    },
                    {
                        "name": "bump",
                        "type": "u8"
                    }
                ]
            }
        },
        {
            "name": "NodeRef",
            "docs": [
                "A reference to a node in the cluster.",
                "The offset is to derive the Node Account.",
                "The current_total_rewards is the total rewards the node has received so far in the current",
                "epoch."
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "offset",
                        "type": "u32"
                    },
                    {
                        "name": "current_total_rewards",
                        "type": "u64"
                    },
                    {
                        "name": "vote",
                        "type": "u8"
                    }
                ]
            }
        },
        {
            "name": "OffChainCircuitSource",
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "source",
                        "type": "string"
                    },
                    {
                        "name": "hash",
                        "type": {
                            "array": [
                                "u8",
                                32
                            ]
                        }
                    }
                ]
            }
        },
        {
            "name": "OnChainCircuitSource",
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "is_completed",
                        "type": "bool"
                    },
                    {
                        "name": "upload_auth",
                        "type": "pubkey"
                    }
                ]
            }
        },
        {
            "name": "Output",
            "docs": [
                "An output of a computation.",
                "We currently don't support encrypted outputs yet since encrypted values are passed via",
                "data objects."
            ],
            "type": {
                "kind": "enum",
                "variants": [
                    {
                        "name": "PlaintextBool"
                    },
                    {
                        "name": "PlaintextU8"
                    },
                    {
                        "name": "PlaintextU16"
                    },
                    {
                        "name": "PlaintextU32"
                    },
                    {
                        "name": "PlaintextU64"
                    },
                    {
                        "name": "PlaintextU128"
                    },
                    {
                        "name": "Ciphertext"
                    },
                    {
                        "name": "ArcisPubkey"
                    },
                    {
                        "name": "PlaintextFloat"
                    }
                ]
            }
        },
        {
            "name": "Parameter",
            "docs": [
                "A parameter of a computation.",
                "We differentiate between plaintext and encrypted parameters and data objects.",
                "Plaintext parameters are directly provided as their value.",
                "Encrypted parameters are provided as an offchain reference to the data.",
                "Data objects are provided as a reference to the data object account."
            ],
            "type": {
                "kind": "enum",
                "variants": [
                    {
                        "name": "PlaintextBool"
                    },
                    {
                        "name": "PlaintextU8"
                    },
                    {
                        "name": "PlaintextU16"
                    },
                    {
                        "name": "PlaintextU32"
                    },
                    {
                        "name": "PlaintextU64"
                    },
                    {
                        "name": "PlaintextU128"
                    },
                    {
                        "name": "Ciphertext"
                    },
                    {
                        "name": "ArcisPubkey"
                    },
                    {
                        "name": "ArcisSignature"
                    },
                    {
                        "name": "PlaintextFloat"
                    },
                    {
                        "name": "ManticoreAlgo"
                    },
                    {
                        "name": "InputDataset"
                    }
                ]
            }
        },
        {
            "name": "ShareCommitHashOutput",
            "docs": [
                "The output of the callback instruction. Provided as a struct with ordered fields",
                "as anchor does not support tuples and tuple structs yet."
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "field_0",
                        "type": {
                            "defined": {
                                "name": "SharedEncryptedStruct",
                                "generics": [
                                    {
                                        "kind": "const",
                                        "value": "1"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "name": "SharedEncryptedStruct",
            "generics": [
                {
                    "kind": "const",
                    "name": "LEN",
                    "type": "usize"
                }
            ],
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "encryption_key",
                        "type": {
                            "array": [
                                "u8",
                                32
                            ]
                        }
                    },
                    {
                        "name": "nonce",
                        "type": "u128"
                    },
                    {
                        "name": "ciphertexts",
                        "type": {
                            "array": [
                                {
                                    "array": [
                                        "u8",
                                        32
                                    ]
                                },
                                {
                                    "generic": "LEN"
                                }
                            ]
                        }
                    }
                ]
            }
        },
        {
            "name": "SignerAccount",
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "bump",
                        "type": "u8"
                    }
                ]
            }
        },
        {
            "name": "Timestamp",
            "type": {
                "kind": "struct",
                "fields": [
                    {
                        "name": "timestamp",
                        "type": "u64"
                    }
                ]
            }
        },
        {
            "name": "X25519Pubkey",
            "type": {
                "kind": "enum",
                "variants": [
                    {
                        "name": "Set",
                        "fields": [
                            {
                                "array": [
                                    "u8",
                                    32
                                ]
                            }
                        ]
                    },
                    {
                        "name": "Unset",
                        "fields": [
                            {
                                "array": [
                                    "u8",
                                    32
                                ]
                            },
                            {
                                "vec": "bool"
                            }
                        ]
                    }
                ]
            }
        }
    ]
}